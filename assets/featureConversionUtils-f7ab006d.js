import{b3 as sr,b2 as ur,b4 as lr,b5 as cr,p as F,am as ir,b6 as E,b7 as ar,b8 as fr,b9 as hr,ba as gr}from"./index-f00bd99f.js";import{s as $,e as P}from"./OptimizedFeature-a0a9dac6.js";import{e as dr}from"./OptimizedFeatureSet-5dc8ee29.js";function w(r,n){return r?n?4:3:n?3:2}const z=()=>ir.getLogger("esri.layers.graphics.featureConversionUtils"),q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},mr=(r,n,o,t,u,e)=>{r[o]=u,r[o+1]=e},B=(r,n,o,t,u,e)=>{r[o]=u,r[o+1]=e,r[o+2]=n[t+2]},yr=(r,n,o,t,u,e)=>{r[o]=u,r[o+1]=e,r[o+2]=n[t+3]},pr=(r,n,o,t,u,e)=>{r[o]=u,r[o+1]=e,r[o+2]=n[t+2],r[o+3]=n[t+3]};function A(r,n,o,t){if(r){if(o)return n&&t?pr:B;if(n&&t)return yr}else if(n&&t)return B;return mr}function U({scale:r,translate:n},o){return Math.round((o-n[0])/r[0])}function R({scale:r,translate:n},o){return Math.round((n[1]-o)/r[1])}function S({scale:r,translate:n},o){return Math.round((o-n[0])/r[0])}function V({scale:r,translate:n},o){return Math.round((o-n[1])/r[1])}function Y({scale:r,translate:n},o,t){return o*r[t]+n[t]}function _r(r,n,o){return r?n?o?D(r):C(r):o?O(r):L(r):null}function L(r){const n=r.coords;return{x:n[0],y:n[1]}}function K(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r}function C(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2]}}function wr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r}function O(r){const n=r.coords;return{x:n[0],y:n[1],m:n[2]}}function br(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.m,r}function D(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2],m:n[3]}}function Mr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r.coords[3]=n.m,r}function Gr(r,n,o,t){let u=L;o&&t?u=D:o?u=C:t&&(u=O);for(const e of n){const{geometry:s,attributes:l}=e,i=s!=null?u(s):null;r.push({attributes:l,geometry:i})}return r}function j(r,n){return r&&n?Mr:r?wr:n?br:K}function Pr(r,n,o,t,u){const e=j(o,t);for(const s of n){const l=s.geometry!=null?e(new P,s.geometry):null;r.push(new $(l,s.attributes,null,E(s,u)))}return r}function Tr(r,n,o=j(n.z!=null,n.m!=null)){return o(r,n)}function Ir(r,n,o,t){for(const{geometry:u,attributes:e}of n)r.push({attributes:e,geometry:u!=null?Q(u,o,t):null});return r}function Q(r,n,o){if(r==null)return null;const t=w(n,o),u=[];for(let e=0;e<r.coords.length;e+=t){const s=[];for(let l=0;l<t;l++)s.push(r.coords[e+l]);u.push(s)}return n?o?{points:u,hasZ:n,hasM:o}:{points:u,hasZ:n}:o?{points:u,hasM:o}:{points:u}}function Zr(r,n,o,t,u){const e=w(o,t);for(const s of n){const l=s.geometry!=null?W(new P,s.geometry,e):null;r.push(new $(l,s.attributes,null,E(s,u)))}return r}function W(r,n,o=w(n.hasZ,n.hasM)){r.lengths[0]=n.points.length;const t=r.coords;let u=0;for(const e of n.points)for(let s=0;s<o;s++)t[u++]=e[s];return r}function Nr(r,n,o,t){for(const{geometry:u,attributes:e}of n)r.push({attributes:e,geometry:u!=null?X(u,o,t):null});return r}function X(r,n,o){if(!r)return null;const t=w(n,o),{coords:u,lengths:e}=r,s=[];let l=0;for(const i of e){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<t;h++)f.push(u[l++]);c.push(f)}s.push(c)}return n?o?{paths:s,hasZ:n,hasM:o}:{paths:s,hasZ:n}:o?{paths:s,hasM:o}:{paths:s}}function xr(r,n,o,t,u){const e=w(o,t);for(const s of n){const l=s.geometry!=null?rr(new P,s.geometry,e):null,i=s.centroid!=null?Tr(new P,s.centroid):null;r.push(new $(l,s.attributes,i,E(s,u)))}return r}function rr(r,n,o=w(n.hasZ,n.hasM)){const{lengths:t,coords:u}=r;let e=0;for(const s of n.paths){for(const l of s)for(let i=0;i<o;i++)u[e++]=l[i];t.push(s.length)}return r}function kr(r,n,o,t){for(const{geometry:u,attributes:e,centroid:s}of n){const l=u!=null?nr(u,o,t):null;if(s!=null){const i=L(s);r.push({attributes:e,centroid:i,geometry:l})}else r.push({attributes:e,geometry:l})}return r}function nr(r,n,o){if(!r)return null;const t=w(n,o),{coords:u,lengths:e}=r,s=[];let l=0;for(const i of e){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<t;h++)f.push(u[l++]);c.push(f)}s.push(c)}return n?o?{rings:s,hasZ:n,hasM:o}:{rings:s,hasZ:n}:o?{rings:s,hasM:o}:{rings:s}}function $r(r,n,o,t,u){for(const e of n){const s=e.geometry!=null?or(new P,e.geometry,o,t):null,l=E(e,u);e.centroid!=null?r.push(new $(s,e.attributes,K(new P,e.centroid),l)):r.push(new $(s,e.attributes,null,l))}return r}function or(r,n,o=n.hasZ,t=n.hasM){return vr(r,n.rings,o,t)}function vr(r,n,o,t){const u=w(o,t),{lengths:e,coords:s}=r;let l=0;Z(r);for(const i of n){for(const c of i)for(let a=0;a<u;a++)s[l++]=c[a];e.push(i.length)}return r}const k=[],v=[];function qr(r,n,o,t,u){k[0]=r;const[e]=tr(v,k,n,o,t,u);return T(k),T(v),e}function tr(r,n,o,t,u,e){if(T(r),!o){for(const s of n){const l=E(s,e);r.push(new $(null,s.attributes,null,l))}return r}switch(o){case"esriGeometryPoint":return Pr(r,n,t,u,e);case"esriGeometryMultipoint":return Zr(r,n,t,u,e);case"esriGeometryPolyline":return xr(r,n,t,u,e);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return $r(r,n,t,u,e);default:z().error("convertToFeatureSet:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${o}'`)),T(r)}return r}function Ar(r,n,o,t){v[0]=r,er(k,v,n,o,t);const u=k[0];return T(k),T(v),u}function Cr(r,n,o){if(r==null)return null;const t=new P;return"hasZ"in r&&n==null&&(n=r.hasZ),"hasM"in r&&o==null&&(o=r.hasM),sr(r)?j(n??r.z!=null,o??r.m!=null)(t,r):ur(r)?or(t,r,n,o):lr(r)?rr(t,r,w(n,o)):cr(r)?W(t,r,w(n,o)):void z().error("convertFromGeometry:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${r}'`))}function Er(r,n,o,t){const u=r&&("coords"in r?r:r.geometry);if(u==null)return null;switch(n){case"esriGeometryPoint":{let e=L;return o&&t?e=D:o?e=C:t&&(e=O),e(u)}case"esriGeometryMultipoint":return Q(u,o,t);case"esriGeometryPolyline":return X(u,o,t);case"esriGeometryPolygon":return nr(u,o,t);default:return z().error("convertToGeometry:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${n}'`)),null}}function Fr(r,n){for(const o of n)r.push({attributes:o.attributes});return r}function er(r,n,o,t,u){if(T(r),o==null)return Fr(r,n);switch(o){case"esriGeometryPoint":return Gr(r,n,t,u);case"esriGeometryMultipoint":return Ir(r,n,t,u);case"esriGeometryPolyline":return Nr(r,n,t,u);case"esriGeometryPolygon":return kr(r,n,t,u);default:z().error("convertToFeatureSet:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${o}'`))}return r}function Or(r){const{spatialReference:n,transform:o,fields:t,hasM:u,hasZ:e,features:s,geometryType:l,exceededTransferLimit:i,queryGeometry:c,queryGeometryType:a}=r,f={features:er([],s,l,e,u),fields:t,geometryType:l,spatialReference:n,queryGeometry:Er(c,a,!1,!1)};return o&&(f.transform=o),i&&(f.exceededTransferLimit=i),u&&(f.hasM=u),e&&(f.hasZ=e),f}function Dr(r,n){const o=new dr,{hasM:t,hasZ:u,features:e,spatialReference:s,geometryType:l,exceededTransferLimit:i,transform:c,fields:a}=r;return a&&(o.fields=a),o.geometryType=l??null,o.spatialReference=s??null,e&&tr(o.features,e,l,u,t,n),i&&(o.exceededTransferLimit=i),t&&(o.hasM=t),u&&(o.hasZ=u),c&&(o.transform=c),o}function jr(r){const{transform:n,features:o,hasM:t,hasZ:u}=r;if(!n)return r;for(const e of o)e.geometry!=null&&J(e.geometry,e.geometry,t,u,n),e.centroid!=null&&J(e.centroid,e.centroid,t,u,n);return r.transform=null,r}function Br(r,n){const{geometryType:o,features:t,hasM:u,hasZ:e}=n;if(!r)return n;for(let s=0;s<t.length;s++){const l=t[s],i=l.weakClone();i.geometry=new P,H(i.geometry,l.geometry,u,e,o,r),l.centroid&&(i.centroid=new P,H(i.centroid,l.centroid,u,e,"esriGeometryPoint",r)),t[s]=i}return n.transform=r,n}function H(r,n,o,t,u,e,s=o,l=t){if(Z(r),!n?.coords.length)return null;const i=q[u],{coords:c,lengths:a}=n,f=w(o,t),h=w(o&&s,t&&l),d=A(o,t,s,l);if(!a.length)return d(r.coords,c,0,0,U(e,c[0]),R(e,c[1])),Z(r,f,0),r;let g,y,b,G,p=0,m=0,M=m;for(const N of a){if(N<i)continue;let I=0;m=M,b=g=U(e,c[p]),G=y=R(e,c[p+1]),d(r.coords,c,m,p,b,G),I++,p+=f,m+=h;for(let x=1;x<N;x++,p+=f)b=U(e,c[p]),G=R(e,c[p+1]),b===g&&G===y||(d(r.coords,c,m,p,b-g,G-y),m+=h,I++,g=b,y=G);I>=i&&(r.lengths.push(I),M=m)}return T(r.coords,M),r.coords.length?r:null}function Hr(r,n,o,t,u,e,s=o,l=t){if(Z(r),!n?.coords.length)return null;const i=q[u],{coords:c,lengths:a}=n,f=w(o,t),h=w(o&&s,t&&l),d=A(o,t,s,l);if(!a.length)return d(r.coords,c,0,0,c[0],c[1]),Z(r,f,0),r;let g=0;const y=e*e;for(const b of a){if(b<i){g+=b*f;continue}const G=r.coords.length/h,p=g,m=g+(b-1)*f;d(r.coords,c,r.coords.length,p,c[p],c[p+1]),_(r.coords,c,f,y,d,p,m),d(r.coords,c,r.coords.length,m,c[m],c[m+1]);const M=r.coords.length/h-G;M>=i?r.lengths.push(M):T(r.coords,G*h),g+=b*f}return r.coords.length?r:null}function zr(r,n,o,t){const u=r[n],e=r[n+1],s=r[o],l=r[o+1],i=r[t],c=r[t+1];let a=s,f=l,h=i-a,d=c-f;if(h!==0||d!==0){const g=((u-a)*h+(e-f)*d)/(h*h+d*d);g>1?(a=i,f=c):g>0&&(a+=h*g,f+=d*g)}return h=u-a,d=e-f,h*h+d*d}function _(r,n,o,t,u,e,s){let l,i=t,c=0;for(let a=e+o;a<s;a+=o)l=zr(n,a,e,s),l>i&&(c=a,i=l);i>t&&(c-e>o&&_(r,n,o,t,u,e,c),u(r,n,r.length,c,n[c],n[c+1]),s-c>o&&_(r,n,o,t,u,c,s))}function Jr(r,n,o,t){if(!n?.coords?.length)return null;const u=w(o,t);let e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(n&&n.coords){const c=n.coords;for(let a=0;a<c.length;a+=u){const f=c[a],h=c[a+1];e=Math.min(e,f),l=Math.max(l,f),s=Math.min(s,h),i=Math.max(i,h)}}return ar(r)?fr(r,e,s,l,i):hr(e,s,l,i,r),r}function J(r,n,o,t,u){const{coords:e,lengths:s}=n,l=w(o,t);if(!e.length)return r!==n&&Z(r),r;gr(u);const{originPosition:i,scale:c,translate:a}=u,f=Rr;f.originPosition=i;const h=f.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const d=f.translate;if(d[0]=a[0]??0,d[1]=a[1]??0,d[2]=a[2]??0,d[3]=a[3]??0,!s.length){for(let y=0;y<l;++y)r.coords[y]=Y(f,e[y],y);return r!==n&&Z(r,l,0),r}let g=0;for(let y=0;y<s.length;y++){const b=s[y];r.lengths[y]=b;for(let m=0;m<l;++m)r.coords[g+m]=Y(f,e[g+m],m);let G=r.coords[g],p=r.coords[g+1];g+=l;for(let m=1;m<b;m++,g+=l){G+=e[g]*h[0],p+=e[g+1]*h[1],r.coords[g]=G,r.coords[g+1]=p;for(let M=2;M<l;++M)r.coords[g+M]=Y(f,e[g+M],M)}}return r!==n&&Z(r,e.length,s.length),r}function Kr(r,n,o,t,u,e){if(Z(r),r.lengths.push(...n.lengths),o===u&&t===e)for(let s=0;s<n.coords.length;s++)r.coords.push(n.coords[s]);else{const s=w(o,t),l=A(o,t,u,e),i=n.coords;for(let c=0;c<i.length;c+=s)l(r.coords,i,r.coords.length,c,i[c],i[c+1])}return r}function Lr(r,n,o,t){let u=0,e=r[t*n],s=r[t*(n+1)];for(let l=1;l<o;l++){const i=e+r[t*(n+l)],c=s+r[t*(n+l)+1],a=(i-e)*(c+s);e=i,s=c,u+=a}return .5*u}function Qr(r,n){const{coords:o,lengths:t}=r;let u=0,e=0;for(let s=0;s<t.length;s++){const l=t[s];e+=Lr(o,u,l,n),u+=l}return Math.abs(e)}function Ur(r,n,o,t){return r*t-o*n===0&&r*o+n*t>0}function Wr(r,n,o,t,u){const e=w(t,u);if(!r.lengths.length){if(r.coords.length<2)return null;const[f,h]=r.coords,d=S(n,f),g=V(n,h);return new P([],[d,g])}const s=new P([],[0,0]),l=q[o],i=o==="esriGeometryPolygon"||o==="esriGeometryPolyline";let c=0,a=0;for(let f=0;f<r.lengths.length;f++){const h=r.lengths[f],d=a;let g=S(n,r.coords[e*c]),y=V(n,r.coords[e*c+1]);s.coords[a++]=g,s.coords[a++]=y;let b=0,G=0,p=1;for(let m=1;m<h;m++){const M=S(n,r.coords[e*(m+c)]),N=V(n,r.coords[e*(m+c)+1]);if(M!==g||N!==y){const I=M-g,x=N-y;i&&Ur(b,G,I,x)?(s.coords[a-2]+=I,s.coords[a-1]+=x,g+=I,y+=x):(s.coords[a++]=M,s.coords[a++]=N,g=M,y=N,b=I,G=x,p+=1)}}p<l?a=d:s.lengths.push(p),c+=h}return s.lengths.length===0?null:s}function Z(r,n=0,o=0){T(r.lengths,o),T(r.coords,n)}function T(r,n=0){r.length!==n&&(r.length=n)}const Rr={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{Q as $,X as D,_r as E,Kr as G,Jr as M,Qr as N,nr as Q,Tr as R,R as T,or as X,Dr as a,U as b,Hr as d,Or as f,H as g,jr as h,Er as l,Br as m,qr as o,tr as r,Ar as s,vr as t,Cr as u,J as w,Wr as x};
